<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Timed Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: #f6f6f6;
        display: flex;
        justify-content: center;
        padding: 40px 16px;
      }
      .container {
        background: #fff;
        max-width: 720px;
        width: 100%;
        border-radius: 12px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.05);
        padding: 32px;
      }
      h1 {
        margin-top: 0;
        font-size: 1.4rem;
      }
      p {
        line-height: 1.6;
        color: #111827;
      }
      .question-text {
        font-size: 1.1rem;
        margin-bottom: 20px;
        font-weight: 600;
      }
      .option {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 14px;
        cursor: pointer;
      }
      .controls {
        margin-top: 24px;
        display: flex;
        gap: 10px;
      }
      button {
        border: none;
        background: #111827;
        color: white;
        padding: 9px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      button[disabled] {
        opacity: 0.4;
        cursor: not-allowed;
      }
      .timer {
        float: right;
        background: #fee2e2;
        border: 2px solid #ef4444;
        border-radius: 999px;
        padding: 6px 16px;
        font-size: 0.9rem;
        color: #b91c1c;
        font-weight: 600;
        transition: background 0.3s, color 0.3s;
        position: relative;
        overflow: hidden;
      }

      /* Progress bar inside the timer */
      .timer::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: 0;
        height: 3px;
        width: 100%;
        background: #ef4444;
        transition: width 1s linear;
      }

      /* Flashing red animation when time is low */
      @keyframes flash {
        0%,
        100% {
          background: #fee2e2;
          color: #b91c1c;
        }
        50% {
          background: #ef4444;
          color: white;
        }
      }

      .timer.flash {
        animation: flash 0.8s ease-in-out infinite;
      }

      .hidden {
        display: none;
      }
      .progress {
        font-size: 0.8rem;
        color: #6b7280;
        margin-bottom: 16px;
      }
      .done-screen {
        text-align: center;
      }
      .consent-screen,
      .info-section {
        text-align: left;
      }
      .consent-screen button,
      .info-section button {
        margin-top: 16px;
      }
      .info-section p,
      .info-section ul {
        line-height: 1.6;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- INFORMATION SHEET SECTION -->
      <div id="info-section" class="info-section">
        <h1>Participant Information Sheet</h1>

        <p>
          <strong>Project title:</strong> The Influence of Time Pressure on
          Risky Decision-Making: A Comparison Between Rare and Common Outcome
          Choices
        </p>

        <p>Dear participant,</p>

        <p>
          Thank you for your interest in taking part in our study. This study
          explores how people make decisions in different situations. Your
          participation will help us better understand general patterns in
          decision-making.
        </p>

        <h3>Your rights as a participant</h3>
        <p>
          Participation in this study is completely voluntary. You are free to
          withdraw at any time, without giving a reason and without any negative
          consequences. All responses are anonymous and used only for academic
          research purposes.
        </p>

        <h3>What will happen in the study</h3>

        <p>
          You will complete a short online survey consisting of 20
          decision-making questions, where you will choose between two option.
          Some of the questions have a time limit.
        </p>

        <h3>Data storage and handling</h3>
        <p>
          Your answers will be stored anonymously. No identifying information
          such as your name, email, or IP address will be collected. The data
          will be used only for educational and research purposes as part of a
          university project.
        </p>

        <h3>Risks and benefits</h3>
        <p>
          There are no known risks associated with this study. Some questions
          will involve short time limits, but there are no real consequences
          beyond the survey itself. While there is no direct personal benefit,
          your participation contributes to understanding human decision-making.
        </p>

        <h3>Contact information</h3>
        <p>
          If you have any questions about the study or your rights as a
          participant, please contact us at
        </p>
        <p>
          You can reach us via our university emails if you have any questions
          or concerns.
        </p>
        <ul>
          <li>Aya: s205466@dtu.dk</li>
          <li>Alec: s205427@dtu.dk</li>
          <li>Jawahir: s205414@dtu.dk</li>
        </ul>

        <p>When you are ready, please continue to the consent form below.</p>

        <div class="controls">
          <button id="continue-to-consent">Continue to Consent Form</button>
        </div>
      </div>

      <!-- CONSENT SCREEN -->
      <div id="consent-screen" class="consent-screen hidden">
        <h1>Participant Consent Form</h1>

        <p>
          <strong>Project Title:</strong> The Influence of Time Pressure on
          Risky Decision-Making: A Comparison Between Rare and Common Outcome
          Choices
        </p>

        <p>
          Before you begin, please read the following statements carefully. By
          ticking the box below and clicking ‚ÄúBegin Survey,‚Äù you confirm that
          you have understood the information and consent to participate in this
          study.
        </p>

        <h3>I confirm that:</h3>
        <ul>
          <li>
            I have read and understood the information provided about this
            study.
          </li>
          <li>I have the opportunity to ask questions.</li>
          <li>I agree to take part voluntarily.</li>
        </ul>

        <h3>I understand that:</h3>
        <ul>
          <li>I can withdraw at any time without consequences.</li>
          <li>
            My responses will be stored anonymously and used only for academic
            research.
          </li>
          <li>No identifying information will be collected.</li>
        </ul>

        <h3>I agree that:</h3>
        <ul>
          <li>
            My fully anonymous data may be analyzed for educational and
            scientific purposes.
          </li>
        </ul>

        <div
          class="controls"
          style="flex-direction: column; align-items: flex-start; gap: 12px"
        >
          <label
            style="
              display: flex;
              align-items: center;
              gap: 8px;
              font-size: 0.95rem;
            "
          >
            <input type="checkbox" id="consent-checkbox" />
            I have read the information above and I consent to participate.
          </label>
          <button id="agree-btn" disabled>Begin Survey</button>
        </div>
      </div>

      <!-- SURVEY SCREEN -->
      <div id="survey-area" class="hidden">
        <h1>Survey</h1>
        <div class="progress" id="progress"></div>
        <div class="question-text" id="question-text"></div>
        <div id="options"></div>
        <div class="controls">
          <button id="next-btn" disabled>Next</button>
        </div>
        <div id="timer" class="timer hidden"></div>
      </div>

      <!-- DONE SCREEN -->
      <!-- DONE SCREEN -->
      <div id="done" class="done-screen hidden" style="text-align: center">
        <div
          style="
            background: #f9fafb;
            border-radius: 12px;
            padding: 40px 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
            animation: fadeIn 0.8s ease-in-out;
          "
        >
          <h2 style="font-size: 1.6rem; margin-bottom: 10px">
            üéâ Thank you for participating!
          </h2>

          <p style="font-size: 1rem; color: #1f2937; margin-bottom: 24px">
            Your responses have been securely recorded.
          </p>

          <p
            style="
              font-size: 1.05rem;
              line-height: 1.8;
              color: #111827;
              max-width: 600px;
              margin: 0 auto 24px auto;
            "
          >
            This study explores how people make decisions in different
            situations, including under time pressure. Your participation helps
            us better understand general patterns in decision-making.
          </p>

          <p style="font-style: italic; color: #4b5563">
            We sincerely appreciate your time and contribution.
          </p>
        </div>
      </div>

    <script>
      // === CONFIGURE YOUR QUESTIONS HERE ===
      const questions = [
        {
          // 1 Rare
          text: "After completing a company challenge, HR hands you two envelopes  one containing a guaranteed local travel voucher, the other entering you into a raffle for an international trip. Which would you choose? ",
          options: [
            "Take a guaranteed travel voucher worth 200 kr",
            "Enter a raffle with a 1% chance to win an international trip worth 200,000 kr",
          ],
          timed: true,
          time: 35,
        },
        {
          // 2 Common
          text: "You go out with your friends on a Friday evening and your friend offers a quick game: you can take a small amount of cash right now, or flip a coin for a chance at a higher payout. What do you do?",
          options: [
            "Take 400 kr for sure",
            "Flip a coin with a 50% chance to win 4,000 kr",
          ],
          timed: false,
        },
        {
          // 3 Rare
          text: "You are suffering from a chronic illness. Your doctor offers you two treatments, one that will definitely give moderate symptom relief, and a new experimental one that might completely cure you or have no effect at all. Which sounds more appealing to you?",
          options: [
            "Take the standard treatment (guaranteed moderate relief)",
            "Try the new treatment with a 5% chance of full cure",
          ],
          timed: false,
        },
        {
          // 4 Common
          text: "You‚Äôre cooking dinner, and your phone suddenly rings. It's your boss calling. You can either pick up now and risk your food burning slightly, or let it ring and call back later. What do you do? ",
          options: [
            "Call back later",
            "Pick up now and make a good impression, but there is a 70% chance your food will burn",
          ],
          timed: true,
          time: 35,
        },
        {
          // 5 Rare
          text: "You‚Äôve been approved for a professional development opportunity, and you can either accept a modest training grant or take a chance applying for an elite fellowship that few people get. What would you go for?",
          options: [
            "Accept a guaranteed 500 kr training grant",
            "Apply to an elite fellowship with a 5% chance to receive 100,000 kr for career development",
          ],
          timed: true,
          time: 35,
        },
        {
          // 6 Common
          text: "You‚Äôre about to leave for an appointment but realize you could stop by the restroom first. You‚Äôd likely still make it on time, but there‚Äôs a small chance you might be late. Do you risk it?",
          options: [
            "Leave now: guaranteed modest comfort during the appointment",
            "Use the restroom with a 70% chance of being on time and fully comfortable",
          ],
          timed: false,
        },
        {
          // 7 Rare
          text: "You‚Äôve been invited to perform at a local event, where you can take a guaranteed small audience slot or audition for the main showcase with a much larger crowd. What would you do?",
          options: [
            "Audition for a major showcase with a 70% chance of high exposure",
            "Guaranteed minor showcase slot with modest exposure",
          ],
          timed: true,
          time: 35,
        },
        {
          // 8 Common
          text: "You‚Äôre stuck on a tricky puzzle. The game offers a guaranteed small hint, or you could complete a quick challenge that might unlock a much bigger clue. What would you choose?",
          options: [
            "Attempt a quick challenge with a 10% chance of earning a big hint",
            "Take a guaranteed small hint",
          ],
          timed: true,
          time: 35,
        },
        {
          // 9 Rare
          text: "On your way home, your GPS shows two routes, one reliable and another is a shortcut that saves you a lot time, but can sometimes backfire as you can get lost. Which route do you take? ",
          options: [
            "Take a route that reliable, you'll be home a bit late",
            "Take a shortcut with a 10% chance to save 20 minutes",
          ],
          timed: false,
        },
        {
          // 10 Common
          text: "You‚Äôre facing a small issue at work. You can schedule a short guaranteed meeting with your supervisor tomorrow, or send a quick message now that usually gets resolved faster. How do you handle it?",
          options: [
            "Schedule a guaranteed short 1:1 next day",
            "Send a message with an 70% chance of same-day resolution",
          ],
          timed: true,
          time: 35,
        },
        {
          // 11 Rare
          text: "Your professor offers a small guaranteed bonus point, but there‚Äôs also an optional tough bonus question that could earn you more. Do you take the safe reward or test your luck?",
          options: [
            "Attempt a tough bonus question with a 10% chance to earn 20 bonus points",
            "Take 2 bonus points for sure",
          ],
          timed: false,
        },
        {
          // 12 Common
          text: "You‚Äôre about to leave for school but your phone battery is low. You can leave now and make it for sure, or charge for a few minutes and maybe still catch the bus. What do you do? ",
          options: [
            "Leave now: guaranteed arrival with low battery",
            "Charge 3 minutes with a 65% chance of catching the bus and having more battery",
          ],
          timed: false,
        },
        {
          // 13 Rare
          text: "You‚Äôre choosing a work tool: one gives a steady boost to your productivity, while a new beta version could either double your efficiency or slow you down completely. Which would you pick?",
          options: [
            "Use a stable tool that guarantees a small productivity boost",
            "Use a beta tool with an 8% chance of a large productivity boost",
          ],
          timed: true,
          time: 35,
        },
        {
          // 14 Common
          text: "It‚Äôs late and you‚Äôre tired after work. You can rest and feel somewhat better tomorrow, or head to the gym ‚Äî which usually feels great afterwards but could leave you even more drained. What do you choose?",
          options: [
            "Go to the gym with a 70% chance of feeling great afterwards",
            "Rest today: guaranteed mild recovery",
          ],
          timed: false,
        },
        {
          // 15 Rare
          text: "You‚Äôre online shopping during a sale. You can take a guaranteed small discount or enter a draw for a big store credit. Which option tempts you more?",
          options: [
            "Take a guaranteed 500 kr discount",
            "Enter a draw with a 4% chance to win a 10,000 kr store credit",
          ],
          timed: false,
        },
        {
          // 16 Common
          text: "You‚Äôve just finished your assignment. You can submit it now for a guaranteed small bonus or spend extra time double-checking it, which usually catches mistakes and earns a higher reward. What do you do?",
          options: [
            "Do a quick check with an 80% chance to earn +3 points",
            "Submit now: guaranteed +1 point",
          ],
          timed: true,
          time: 35,
        },
        {
          // 17 Rare
          text: "Your teacher offers an optional project. You can take a guaranteed modest grade bump or complete a difficult extra task that could raise your final grade significantly. What feels right to you?",
          options: [
            "Accept a guaranteed +1% grade bump",
            "Attempt an extra project with a 5% chance of +10% grade bump",
          ],
          timed: true,
          time: 35,
        },
        {
          // 18 Common
          text: "You‚Äôve just finished a group project. You can quietly accept a small amount of credit for your work or speak up during the review, which often leads to more recognition. What would you do?",
          options: [
            "Accept guaranteed small individual credit",
            "Speak up with an 85% chance of higher team credit",
          ],
          timed: false,
        },
        {
          // 19 Rare
          text: "You‚Äôve just been paid and see an ad for a huge lottery jackpot. You can keep a small amount of your cash safely or spend it on a ticket for the chance to win big. What would you choose?",
          options: [
            "Take 200 kr for sure",
            "Buy a ticket with a 1% chance to win 20,000 kr (the ticket itself is free for you)",
          ],
          timed: false,
        },
        {
          // 20 Common
          text: "You‚Äôre checking out online. You can take a guaranteed small discount now or select a slower delivery option that usually brings a larger discount. Which option do you pick? ",
          options: [
            "Take a guaranteed 100 kr discount",
            "Choose promo delivery with an 80% chance of a 500 kr discount",
          ],
          timed: true,
          time: 35,
        },
      ];
      const questions1 = [
        {
          text: "You can take a guaranteed small cash amount or buy a ticket for a large prize. (Rare)",
          options: [
            "Take 300 kr for sure",
            "Buy a ticket with a 3% chance to win 20,000 kr (the ticket itself is free for you)",
          ],
          timed: true,
          time: 35,
        },
        {
          text: "You can accept a guaranteed small discount or choose a delivery option that usually yields a bigger discount. (Common)",
          options: [
            "Take a guaranteed 100 kr discount",
            "Choose promo delivery with an 80% chance of a 300 kr discount",
          ],
          timed: false,
        },
      ];

      // === DOM ELEMENTS ===
      const infoSection = document.getElementById("info-section");
      const consentScreen = document.getElementById("consent-screen");
      const surveyArea = document.getElementById("survey-area");
      const doneScreen = document.getElementById("done");

      const continueBtn = document.getElementById("continue-to-consent");
      const agreeBtn = document.getElementById("agree-btn");
      const consentCheckbox = document.getElementById("consent-checkbox");

      // survey elements (these were missing üëá)
      const qTextEl = document.getElementById("question-text");
      const optionsEl = document.getElementById("options");
      const nextBtn = document.getElementById("next-btn");
      const progressEl = document.getElementById("progress");
      const timerEl = document.getElementById("timer");

      // === STATE ===
      let currentIndex = 0;
      let answers = [];
      let selectedOption = null;
      let countdownId = null;
      let timeLeft = 0;

      // === FLOW LOGIC ===
      continueBtn.addEventListener("click", () => {
        infoSection.classList.add("hidden");
        consentScreen.classList.remove("hidden");
      });

      consentCheckbox.addEventListener("change", () => {
        agreeBtn.disabled = !consentCheckbox.checked;
      });

      agreeBtn.addEventListener("click", () => {
        consentScreen.classList.add("hidden");
        surveyArea.classList.remove("hidden");
        showQuestion(currentIndex);
      });

      // === RENDER QUESTION ===
      function showQuestion(index) {
        const q = questions[index]; // use the full 20-question list
        qTextEl.textContent = q.text;
        progressEl.textContent = `Question ${index + 1} of ${questions.length}`;

        // build options
        optionsEl.innerHTML = "";
        q.options.forEach((opt) => {
          const label = document.createElement("label");
          label.className = "option";

          const input = document.createElement("input");
          input.type = "radio";
          input.name = "option";
          input.value = opt;

          input.addEventListener("change", () => {
            selectedOption = opt;
            nextBtn.disabled = false;
          });

          const span = document.createElement("span");
          span.textContent = opt;

          label.appendChild(input);
          label.appendChild(span);
          optionsEl.appendChild(label);
        });

        // reset button + timer
        selectedOption = null;
        nextBtn.disabled = true;

        clearInterval(countdownId);
        if (q.timed) {
          const secs = typeof q.time === "number" ? q.time : 40;
          startTimer(secs);
        } else {
          timerEl.classList.add("hidden");
        }
      }

      function startTimer(seconds) {
        timeLeft = seconds;
        timerEl.textContent = `Time left: ${timeLeft}s`;
        timerEl.classList.remove("hidden");

        countdownId = setInterval(() => {
          timeLeft--;
          timerEl.textContent = `Time left: ${timeLeft}s`;

          if (timeLeft <= 0) {
            clearInterval(countdownId);
            // if no answer, record timeout
            if (!selectedOption) {
              answers.push({
                question: questions[currentIndex].text,
                answer: "No answer (timed out)",
                timed: !!questions[currentIndex].timed,
              });
              goNext();
            } else {
              submitCurrentAndNext();
            }
          }
        }, 1000);
      }

      function submitCurrentAndNext() {
        answers.push({
          question: questions[currentIndex].text,
          answer: selectedOption || "",
          timed: !!questions[currentIndex].timed,
        });

        goNext();
      }

      function goNext() {
        currentIndex++;
        if (currentIndex >= questions.length) {
          finishSurvey();
        } else {
          showQuestion(currentIndex);
        }
      }

      async function finishSurvey() {
        clearInterval(countdownId);
        surveyArea.classList.add("hidden");
        doneScreen.classList.remove("hidden");

        const endpoint =
          "https://script.google.com/macros/s/AKfycbyW_FrU7aq4aoi-iiCobxezRyA_4gdK-rgeAynGSkROsN8xsvoKThJ213d3nWNBP8Sr/exec";

        try {
          await fetch(endpoint, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(answers),
          });
        } catch (err) {
          console.error("Error sending responses:", err);
        }
      }

      nextBtn.addEventListener("click", () => {
        clearInterval(countdownId);
        submitCurrentAndNext();
      });
    </script>
  </body>
</html>
